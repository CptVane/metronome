{% extends 'base.html' %}

{% block content %}
<!-- Header Section -->
<div class="header bg-dark text-white p-3 d-flex justify-content-between align-items-center w-100" style="position: fixed; top: 0; left: 0; z-index: 1030;">
    <h1 class="m-0">Dashboard</h1>
    <div class="d-flex justify-content-center align-items-center gap-3 w-50">
        <!-- Filter Section (Centered in the Header) -->
        <form id="filter-form" method="get" action="/" class="d-flex align-items-center gap-2 m-0">
            <input type="date" id="start-date" name="start_date" class="form-control bg-dark text-white" value="{{ start_date }}">
            <input type="date" id="end-date" name="end_date" class="form-control bg-dark text-white" value="{{ end_date }}">
        </form>
    </div>
    <!-- Add Work Button -->
    <a href="{{ url_for('add_work') }}" class="btn btn-primary">+ Add Work</a>
</div>

<!-- Main Content -->
<div class="container-fluid mt-5 pt-5">
    <!-- Workdays Table -->
    <div class="table-responsive mt-3">
        <table class="table table-bordered text-white">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Work Name</th>
                    <th>Client Name</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Break Time</th>
                    <th>Work Time</th>
                    <th>Total Fee</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for workday in workdays %}
                    <tr id="row-{{ workday.id }}">
                        <td>{{ workday.date.strftime('%d/%m/%Y') }}</td>
                        <td>{{ workday.event.name }}</td>
                        <td>
                            <span class="color-circle" style="background-color: {{ workday.event.client.color }};"></span>
                            {{ workday.event.client.name }}
                        </td>
                        <td>{{ workday.start_time.strftime('%H:%M') }}</td>
                        <td>{{ workday.end_time.strftime('%H:%M') }}</td>
                        <td>{{ workday.break_time }}</td>
                        <td>{{ workday.formatted_work_time }}</td>
                        <td>â‚¬ {{ '%.2f' % workday.total_fee }}</td>
                        <td class="text-center">
                            <!-- Edit Button -->
                            <form action="/edit_workday/{{ workday.id }}" method="GET" class="d-inline">
                                <button type="submit" class="btn btn-link text-primary" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </form>

                            <!-- Duplicate Button -->
                            <form action="/duplicate_workday/{{ workday.id }}" method="POST" class="d-inline">
                                <button type="submit" class="btn btn-link text-success" title="Duplicate">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </form>

                            <!-- Erase Button -->
                            <button
                                type="button"
                                class="btn btn-link text-danger delete-button"
                                title="Erase"
                                data-workid="{{ workday.event.work_id }}"
                                data-date="{{ workday.date.strftime('%d/%m/%Y') }}"
                                data-row-id="row-{{ workday.id }}"
                                data-form-id="form-delete-{{ workday.id }}">
                                <i class="fas fa-trash"></i>
                            </button>
                            <form id="form-delete-{{ workday.id }}" action="/delete_workday/{{ workday.id }}" method="POST" class="d-none"></form>
                        </td>
                    </tr>
                    {% endfor %}

            </tbody>
        </table>
        
    </div>
</div>


<script src="{{ url_for('static', filename='js/delete_confirm_highlight.js') }}"></script>
{% endblock %}
